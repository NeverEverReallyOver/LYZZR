# 修复嘉宾性别匹配与展示问题的计划

## 1. 强制联动刷新 (Auto-Refresh)
*   **目标**: 只要用户修改了左侧的“期望性别” (Preferred Gender)，右侧嘉宾池必须立即重新生成。
*   **实现**: 在 `st.sidebar.radio` 或其他输入控件上使用 `on_change` 回调，或者利用 Streamlit 的 rerun 机制，检测到 `pref_gender` 变化时清空 `st.session_state.candidate_pool`。

## 2. 增强 UI 可视化 (Visual Clarity)
*   **目标**: 让嘉宾的性别在卡片上一眼可见。
*   **实现**: 修改 `app.py` 中的嘉宾卡片渲染代码。
    *   *Old*: `st.markdown(f"**{candidate.name}** {gender_icon}")`
    *   *New*: `st.markdown(f"**{candidate.name}**")` 下一行加 `st.caption(f"{gender_text} {gender_icon} | {age}岁")`

## 3. 代码审查与修正
*   再次检查 `src/generator.py`，确保 `generate_random_agent` 函数在接收 `preferences` 参数时，**绝对**不会生成错误性别的 Agent。

## 4. 验证
*   运行应用，将期望性别设为“男”，检查广场是否全是男性。
*   切换为“女”，检查广场是否立即变为全女性。