I have diagnosed the environment and confirmed that `agentscope` and `pywin32` are installed and importable in the terminal. The errors you are facing are likely due to **Streamlit's execution model** conflicting with **AgentScope's initialization**, or specific runtime configuration issues (like repeated initialization or DLL path conflicts).

I will refactor the project to ensure a robust, smooth execution:

1.  **Create `src/boot.py` (Environment Bootstrap)**
    *   Move the complex "DLL patching" logic out of `app.py`.
    *   Centralize environment setup to ensure it runs correctly before any library imports.

2.  **Robust AgentScope Initialization (`src/agentscope_adapter.py`)**
    *   Implement an **idempotent initialization** function. It will check if AgentScope is already initialized before calling `init()` again, preventing crashes during Streamlit re-runs.
    *   Add error handling for API connection issues.

3.  **Refactor `app.py` (Main UI)**
    *   Clean up the code by importing the bootstrap module.
    *   Add a global `try...except` block around the main logic to catch runtime errors and display them friendly in the UI (instead of a "Connection Error" or stack trace).

4.  **Verify & Test**
    *   Ensure the "Simulation" loop (Agent A vs Agent B) runs without interruption.
    *   Verify the "Turing Calibration" and "Evaluation" features still work within the new architecture.

This refactor separates concerns (Environment vs UI vs Logic) and makes the system much more stable.
