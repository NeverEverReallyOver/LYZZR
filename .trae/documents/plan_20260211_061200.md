# 将项目迁移至 AgentScope 框架的计划

您希望将当前的“恋与代理人”项目重构并部署在 `AgentScope` 框架上。这意味着我们将使用 AgentScope 提供的更强大的 Agent 基类、消息机制和模型接口来替换我们手写的 `LLMService` 和部分 `ChatSession` 逻辑。

## 1. 环境准备
*   **安装依赖**: 安装 `agentscope` 库。

## 2. 核心适配层 (`src/agentscope_adapter.py`)
我们将创建一个新的适配器模块，用于连接我们现有的业务逻辑（`AgentProfile`）和 AgentScope 的框架。
*   **模型配置**: 配置 AgentScope 以支持 Kimi (Moonshot) API（通过 OpenAI 兼容接口）。
*   **Agent 封装**: 创建一个继承自 `agentscope.agents.DialogAgent` 的 `DatingAgent` 类。
    *   它将接收我们现有的 `AgentProfile` 对象。
    *   它将使用 `profile.generate_system_prompt()` 的结果作为 `sys_prompt`。
*   **初始化函数**: 实现 `init_agentscope(api_key)` 来设置全局模型配置。

## 3. 重构对话引擎 (`src/engine.py`)
*   **修改 `ChatSession`**:
    *   不再直接调用 `LLMService`。
    *   改为实例化两个 `DatingAgent` (AgentScope 对象)。
    *   使用 AgentScope 的消息传递机制 (`msg = agent_a(msg)`) 来驱动对话循环。
    *   保留现有的 UI 回调 (`on_message`) 和日志保存功能，适配 AgentScope 的消息格式（`msg.content`）。

## 4. 前端集成 (`app.py`)
*   **初始化**: 在用户输入 API Key 后，调用 `init_agentscope`。
*   **实例化**: 使用新的适配器创建 AgentScope 风格的 Agent。
*   **运行**: 保持现有的 UI 逻辑不变，但在底层调用重构后的 `ChatSession`。

## 5. 验证
*   运行 `streamlit run app.py`，验证 Agent 能够正常对话，且使用了 AgentScope 的底层能力。

这样做的好处是保留了我们之前做的所有捏人、匹配、渐进式 Prompt 逻辑，同时底层换成了更强大、可扩展的 AgentScope 框架。