好的，我已经记录了“永远使用中文”到长期记忆中。

为了让 Agent 的对话更具个人特点、更像真人，并且根据对方是否符合期待表现出热情或冷淡，我将对系统提示词（System Prompt）的生成逻辑进行深度改造。

**核心思路：**
让 Agent 拥有“心理活动”和“态度策略”。Agent 不仅仅是在回答问题，而是在评估对方。

1. **注入“择偶标准”与“对方画像”**：
   在生成 System Prompt 时，不仅告诉 Agent “你是谁”，还要告诉它 “你喜欢什么样的人” 以及 “你正在跟谁聊天”。

2. **植入“态度判断逻辑”**：
   在 Prompt 中明确指令：

   * **判断阶段**：先对比【对方资料】和【我的偏好】。

   * **高匹配（符合期待）**：表现出**高热情**。主动开启话题，使用更多 emoji，回复字数较多，语气活泼/温柔（取决于人设），对对方的细节感兴趣。

   * **低匹配（不符合期待）**：表现出**低热情/礼貌性冷淡**。回复简短，不主动提问，语气客套疏离，甚至委婉地结束话题（如“嗯嗯”、“挺好的”、“我去洗澡了”）。

3. **增强人设风格（Persona Voice）**：
   根据 MBTI 和职业，定义具体的语言风格。

   * 例如：程序员 (INTP) -> 逻辑清晰，可能用一点技术梗，稍微内向。

   * 例如：销售 (ESFP) -> 极其自来熟，表情包大户，热情洋溢。

**具体实施计划：**

1. **修改** **`src/agent_builder.py`** **中的** **`AgentProfile`** **类**：

   * 修改 `generate_system_prompt` 方法，增加 `target_profile`（对方资料）作为参数。

   * 在 Prompt 中增加 `【对方信息】` 板块。

   * 在 Prompt 中增加 `【内心独白与策略】` 板块，强制 Agent 在回复前先进行心理评估（CoT，但不需要输出，只需要体现在语气中）。

   * 定义具体的“热情”和“冷淡”的行为指南。

2. **修改** **`src/agentscope_adapter.py`**：

   * 更新 `DatingAgent` 的初始化逻辑，使其在创建时接收 `target_profile`。

   * 调用 `profile.generate_system_prompt(..., target_profile=...)` 来生成带有针对性的 Prompt。

3. **修改** **`app.py`** **和** **`src/engine.py`**：

   * 在创建聊天会话时，确保将 Agent A 的 Profile 传给 Agent B，反之亦然，实现“知己知彼”。

通过这套机制，Agent 就会像真人一样：“这一眼看过去不是我的菜，我就敷衍一下；哇，这个是我的理想型，我要主动出击！”

计划：

1. 修改 `src/agent_builder.py`：增强 System Prompt 模板，加入动态态度逻辑。
2. 修改 `src/agentscope_adapter.py`：传入匹配对象信息。
3. 修改 `src/engine.py` / `app.py`：传递上下文。

